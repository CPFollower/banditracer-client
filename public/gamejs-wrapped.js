require.define({"gamejs/display":function(f,a){var h=f("../gamejs").Surface,e=null;a.init=function(){var b=null;d()===null&&(b=document.createElement("canvas"),b.setAttribute("id","gjs-canvas"),document.body.appendChild(b));(b=document.getElementById("gjs-loader"))&&b.parentNode.removeChild(b)};a.setMode=function(b){var g=d();g.width=b[0];g.height=b[1];return c()};a.setCaption=function(b){document.title=b};a._getCanvasOffset=function(){var b=d().getBoundingClientRect();return[b.left,b.top]};var c=
a.getSurface=function(){if(e===null){var b=d();e=new h([b.clientWidth,b.clientHeight]);e._canvas=b}return e},d=function(){var b=null;Array.prototype.slice.call(document.getElementsByTagName("canvas")).every(function(d){if(d.getAttribute("id")=="gjs-canvas")return b=d,!1;return!0});return b}}},["gamejs"]);
require.define({"gamejs/time":function(f,a){var h={},e={};a.init=function(){Date.now();setInterval(c,10)};a.fpsCallback=function(d,b,g){g=parseInt(1E3/g,10);h[g]=h[g]||[];e[g]=e[g]||0;h[g].push({rawFn:d,callback:function(g){d.apply(b,[g])}})};a.deleteCallback=function(d,b){var b=parseInt(1E3/b,10),g=h[b];g&&(h[b]=g.filter(function(b){if(b.rawFn!==d)return!0;return!1}))};var c=function(){function d(b){b.callback(a)}var b=Date.now(),g;for(g in e){e[g]||(e[g]=b);var a=b-e[g];g<=a&&(e[g]=b,h[g].forEach(d,
this))}}}},[]);
require.define({"gamejs/utils/binaryheap":function(f,a){var h=a.BinaryHeap=function(a){this.content=[];this.scoreFunction=a;return this};h.prototype.push=function(a){this.content.push(a);this.sinkDown(this.content.length-1)};h.prototype.pop=function(){var a=this.content[0],c=this.content.pop();this.content.length>0&&(this.content[0]=c,this.bubbleUp(0));return a};h.prototype.remove=function(a){if(!this.content.some(function(c,d){if(c==a){var b=this.content.pop();d!=this.content.length&&(this.content[d]=
b,this.scoreFunction(b)<this.scoreFunction(a)?this.sinkDown(d):this.bubbleUp(d));return!0}return!1},this))throw Error("Node not found.");};h.prototype.size=function(){return this.content.length};h.prototype.sinkDown=function(a){for(var c=this.content[a];a>0;){var d=Math.floor((a+1)/2)-1,b=this.content[d];if(this.scoreFunction(c)<this.scoreFunction(b))this.content[d]=c,this.content[a]=b,a=d;else break}};h.prototype.bubbleUp=function(a){for(var c=this.content.length,d=this.content[a],b=this.scoreFunction(d);;){var g=
(a+1)*2,j=g-1,h=null;if(j<c){var l=this.scoreFunction(this.content[j]);l<b&&(h=j)}if(g<c&&this.scoreFunction(this.content[g])<(h===null?b:l))h=g;if(h!==null)this.content[a]=this.content[h],this.content[h]=d,a=h;else break}}}},[]);
require.define({"gamejs/utils/vectors":function(f,a){var h=f("./math");a.distance=function(d,b){return c(e(d,b))};var e=a.substract=function(d,b){return[d[0]-b[0],d[1]-b[1]]};a.add=function(d,b){return[d[0]+b[0],d[1]+b[1]]};a.multiply=function(d,b){if(typeof b==="number")return[d[0]*b,d[1]*b];return[d[0]*b[0],d[1]*b[1]]};a.divide=function(d,b){if(typeof b==="number")return[d[0]/b,d[1]/b];throw Error("only divide by scalar supported");};var c=a.len=function(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])};
a.unit=function(d){var b=c(d);if(b)return[d[0]/b,d[1]/b];return[0,0]};a.rotate=function(d,b){b=h.normaliseRadians(b);return[d[0]*Math.cos(b)-d[1]*Math.sin(b),d[0]*Math.sin(b)+d[1]*Math.cos(b)]};a.dot=function(d,b){return d[0]*b[0]+d[1]*b[1]};a.angle=function(d,b){var a=c(d),j=c(b);return a&&j?Math.acos((d[0]*b[0]+d[1]*b[1])/(a*j)):0}}},["gamejs/utils/math"]);
require.define({"gamejs/utils/matrix":function(f,a){a.identity=function(){return[1,0,0,1,0,0]};a.add=function(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2],a[3]+c[3],a[4]+c[4],a[5]+c[5],a[6]+c[6]]};var h=a.multiply=function(a,c){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],a[0]*c[4]+a[2]*c[5]+a[4],a[1]*c[4]+a[3]*c[5]+a[5]]};a.translate=function(a,c,d){return h(a,[1,0,0,1,c,d])};a.rotate=function(a,c){var d=Math.sin(c),b=Math.cos(c);return h(a,[b,d,-d,b,0,0])};
a.rotation=function(a){return Math.atan2(a[1],a[0])};a.scale=function(a,c){return h(a,[c[0],0,0,c[1],0,0])}}},[]);
require.define({"gamejs/utils/objects":function(f,a){a.extend=function(a,d){if(a===void 0)throw Error("unknown subClass");if(d===void 0)throw Error("unknown superClass");var b=new Function;b.prototype=d.prototype;a.prototype=new b;a.prototype.constructor=a;a.superClass=d.prototype;a.superConstructor=d};a.merge=function(){for(var a={},d=arguments.length;d>0;--d){var b=arguments[d-1],g;for(g in b)a[g]=b[g]}return a};var h=a.keys=function(a){if(Object.keys)return Object.keys(a);var d=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,
b)&&d.push(b);return d},e=a.accessor=function(a,d,b,g){Object.defineProperty!==void 0?Object.defineProperty(a,d,{get:b,set:g}):Object.prototype.__defineGetter__!==void 0&&(a.__defineGetter__(d,b),g&&a.__defineSetter__(d,g))};a.accessors=function(a,d){h(d).forEach(function(b){e(a,b,d[b].get,d[b].set)})}}},[]);require.define({"gamejs/utils/arrays":function(f,a){a.remove=function(a,e){return e.splice(e.indexOf(a),1)}}},[]);
require.define({"gamejs/utils/math":function(f,a){a.normaliseDegrees=function(a){a%=360;a<0&&(a+=360);return a};a.normaliseRadians=function(a){a%=2*Math.PI;a<0&&(a+=2*Math.PI);return a};a.degrees=function(a){return a*(180/Math.PI)};a.radians=function(a){return a*(Math.PI/180)}}},[]);
require.define({"gamejs/event":function(f,a){var h=f("./display"),e=f("../gamejs");a.K_UP=38;a.K_DOWN=40;a.K_RIGHT=39;a.K_LEFT=37;a.K_SPACE=32;a.K_BACKSPACE=8;a.K_TAB=9;a.K_ENTER=13;a.K_SHIFT=16;a.K_CTRL=17;a.K_ALT=18;a.K_ESC=27;a.K_0=48;a.K_1=49;a.K_2=50;a.K_3=51;a.K_4=52;a.K_5=53;a.K_6=54;a.K_7=55;a.K_8=56;a.K_9=57;a.K_a=65;a.K_b=66;a.K_c=67;a.K_d=68;a.K_e=69;a.K_f=70;a.K_g=71;a.K_h=72;a.K_i=73;a.K_j=74;a.K_k=75;a.K_l=76;a.K_m=77;a.K_n=78;a.K_o=79;a.K_p=80;a.K_q=81;a.K_r=82;a.K_s=83;a.K_t=84;a.K_u=
85;a.K_v=86;a.K_w=87;a.K_x=88;a.K_y=89;a.K_z=90;a.K_KP1=97;a.K_KP2=98;a.K_KP3=99;a.K_KP4=100;a.K_KP5=101;a.K_KP6=102;a.K_KP7=103;a.K_KP8=104;a.K_KP9=105;a.QUIT=0;a.KEY_DOWN=1;a.KEY_UP=2;a.MOUSE_MOTION=3;a.MOUSE_UP=4;a.MOUSE_DOWN=5;a.MOUSE_WHEEL=6;var c=[];a.get=function(){return c.splice(0,c.length)};a.poll=function(){return c.pop()};a.post=function(a){c.push(a)};a.Event=function(){this.pos=this.button=this.rel=this.key=this.type=null};a.init=function(){function d(b){var a=h._getCanvasOffset();c.push({type:e.event.MOUSE_WHEEL,
pos:[b.clientX-a[0],b.clientY-a[1]],delta:b.detail||-b.wheelDeltaY/40})}document.addEventListener("mousedown",function(b){var a=h._getCanvasOffset();c.push({type:e.event.MOUSE_DOWN,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},!1);document.addEventListener("mouseup",function(b){var a=h._getCanvasOffset();c.push({type:e.event.MOUSE_UP,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);document.addEventListener("keydown",function(b){var d=b.keyCode||b.which;c.push({type:e.event.KEY_DOWN,key:d,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey});(!b.ctrlKey&&!b.metaKey&&(d>=a.K_LEFT&&d<=a.K_DOWN||d>=a.K_0&&d<=a.K_z||d>=a.K_KP1&&d<=a.K_KP9||d===a.K_SPACE||d===a.K_TAB||d===a.K_ENTER)||d===a.K_ALT||d===a.K_BACKSPACE)&&b.preventDefault()},!1);document.addEventListener("keyup",function(b){c.push({type:e.event.KEY_UP,key:b.keyCode,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);var b=[];document.addEventListener("mousemove",function(a){var d=h._getCanvasOffset(),d=[a.clientX-d[0],a.clientY-d[1]],i=[];b.length&&(i=[b[0]-d[0],b[1]-d[1]]);c.push({type:e.event.MOUSE_MOTION,pos:d,rel:i,buttons:null,timestamp:a.timeStamp});b=d},!1);document.addEventListener("mousewheel",d,!1);document.addEventListener("DOMMouseScroll",d,!1);document.addEventListener("beforeunload",function(){c.push({type:e.event.QUIT})},!1)}}},["gamejs/display","gamejs"]);
require.define({"gamejs/font":function(f,a){var h=f("../gamejs").Surface,e=f("./utils/objects"),c=a.Font=function(a){this.sampleSurface=new h([10,10]);this.sampleSurface.context.font=a;this.sampleSurface.context.textAlign="start";this.sampleSurface.context.textBaseline="bottom";return this};c.prototype.render=function(a,b){var g=this.size(a),g=new h(g),c=g.context;c.save();c.font=this.sampleSurface.context.font;c.textBaseline=this.sampleSurface.context.textBaseline;c.textAlign=this.sampleSurface.context.textAlign;
c.fillStyle=c.strokeStyle=b||"#000000";c.fillText(a,0,g.rect.height,g.rect.width);c.restore();return g};c.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width,this.fontHeight]};e.accessors(c.prototype,{fontHeight:{get:function(){return this.sampleSurface.context.measureText("M").width*1.5}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/transform":function(f,a){var h=f("../gamejs").Surface,e=f("./utils/matrix");f("./utils/math");var c=f("./utils/vectors");a.rotate=function(a,b){var g=a.getSize(),j=b*Math.PI/180,i=g;if(b%180!==0)var i=a.getRect(),i=[[-i.width/2,i.height/2],[i.width/2,i.height/2],[-i.width/2,-i.height/2],[i.width/2,-i.height/2]].map(function(b){return c.rotate(b,j)}),l=i.map(function(b){return b[0]}),f=i.map(function(b){return b[1]}),i=Math.min.apply(Math,l),l=Math.max.apply(Math,l),m=Math.min.apply(Math,
f),f=Math.max.apply(Math,f),i=[l-i,f-m];f=new h(i);l=a._matrix;a._matrix=e.translate(a._matrix,g[0]/2,g[1]/2);a._matrix=e.rotate(a._matrix,j);a._matrix=e.translate(a._matrix,-g[0]/2,-g[1]/2);f.blit(a,[(i[0]-g[0])/2,(i[1]-g[1])/2]);a._matrix=l;return f};a.scale=function(a,b){var g=b[0],c=b[1],i=a.getSize(),i=[i[0]*b[0],i[1]*b[1]],i=new h(i);a._matrix=e.scale(a._matrix,[g,c]);i.blit(a);return i};a.flip=function(a,b,g){var c=a.getSize(),i=new h(c),e=1,f=1,m=0,n=0;b===!0&&(e=-1,m=-c[0]);g===!0&&(f=-1,
n=-c[1]);i.context.save();i.context.scale(e,f);i.context.drawImage(a.canvas,m,n);i.context.restore();return i}}},["gamejs","gamejs/utils/matrix","gamejs/utils/math","gamejs/utils/vectors"]);
require.define({"gamejs/sprite":function(f,a){f("../gamejs");var h=f("./utils/arrays"),e=a.Sprite=function(){this._groups=[];this._alive=!0;this.rect=this.image=null;return this};e.prototype.kill=function(){this._alive=!1;this._groups.forEach(function(b){b.remove(this)},this)};e.prototype.remove=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){b.remove(this)},this)};e.prototype.add=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){b.add(this)},this)};e.prototype.draw=function(b){b.blit(this.image,
this.rect)};e.prototype.update=function(){};e.prototype.isDead=function(){return!this._alive};var c=a.Group=function(b){this._sprites=[];(b instanceof e||b instanceof Array&&b.length&&b[0]instanceof e)&&this.add(b);return this};c.prototype.update=function(){var b=arguments;this._sprites.forEach(function(a){a.update.apply(a,b)},this)};c.prototype.add=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){this._sprites.push(b);b._groups.push(this)},this)};c.prototype.remove=function(b){b instanceof
Array||(b=[b]);b.forEach(function(b){h.remove(b,this._sprites);h.remove(this,b._groups)},this)};c.prototype.has=function(b){b instanceof Array||(b=[b]);return b.every(function(b){return this._sprites.indexOf(b)!==-1},this)};c.prototype.sprites=function(){return this._sprites};c.prototype.draw=function(){var b=arguments;this._sprites.forEach(function(a){a.draw.apply(a,b)},this)};c.prototype.clear=function(b,a){this._sprites.forEach(function(d){b.blit(a,d.rect)},this)};c.prototype.empty=function(){this._sprites=
[]};c.prototype.collidePoint=function(){var b=Array.prototype.slice.apply(arguments);return this._sprites.filter(function(a){return a.rect.collidePoint.apply(a.rect,b)},this)};c.prototype.forEach=function(){Array.prototype.forEach.apply(this._sprites,arguments)};c.prototype.some=function(){return Array.prototype.some.apply(this._sprites,arguments)};a.spriteCollide=function(b,a,c,h){var h=h||d,c=c||!1,e=[];a.sprites().forEach(function(a){h(b,a)&&(c&&a.kill(),e.push(a))});return e};a.groupCollide=function(b,
a,c,h,e){var c=c||!1,h=h||!1,f=[],m=e||d;b.sprites().forEach(function(b){a.sprites().forEach(function(a){m(b,a)&&(c&&b.kill(),h&&a.kill(),f.push({a:b,b:a}))})});return f};var d=a.collideRect=function(b,a){return b.rect.collideRect(a.rect)};a.collideMask=function(a,d){if(!a.mask||!d.mask)throw Error("Both sprites must have 'mask' attribute set to an gamejs.mask.Mask");return a.mask.overlap(d.mask,[d.rect.left-a.rect.left,d.rect.top-a.rect.top])};a.collideCircle=function(a,d){return a.rect.center[0]*
a.rect.center[0]+a.rect.center[1]*a.rect.center[1]<=(a.radius*a.radius||(a.rect.width*a.rect.width+a.rect.height*a.rect.height)/4)+(d.radius*d.radius||(d.rect.width*d.rect.width+d.rect.height*d.rect.height)/4)}}},["gamejs","gamejs/utils/arrays"]);
require.define({"gamejs/draw":function(f,a){a.line=function(a,e,c,d,b){a=a.context;a.save();a.beginPath();a.strokeStyle=e;a.lineWidth=b||1;a.moveTo(c[0],c[1]);a.lineTo(d[0],d[1]);a.stroke();a.restore()};a.lines=function(a,e,c,d,b){c=c||!1;a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;for(e=0;e<d.length;e++)b=d[e],e===0?a.moveTo(b[0],b[1]):a.lineTo(b[0],b[1]);c&&a.lineTo(d[0][0],d[0][1]);a.stroke();a.restore()};a.circle=function(a,e,c,d,b){if(!d)throw Error("[circle] radius required argument");
if(!c||!(c instanceof Array))throw Error("[circle] pos must be given & array"+c);a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;a.arc(c[0],c[1],d,0,2*Math.PI,!0);b===void 0||b===0?a.fill():a.stroke();a.restore()};a.rect=function(a,e,c,d){a=a.context;a.save();a.strokeStyle=a.fillStyle=e;isNaN(d)||d===0?a.fillRect(c.left,c.top,c.width,c.height):(a.lineWidth=d||1,a.strokeRect(c.left,c.top,c.width,c.height));a.restore()};a.arc=function(a,e,c,d,b,g){a=a.context;a.save();
a.strokeStyle=a.fillStyle=e;a.arc(c.center[0],c.center[1],c.width/2,d*(Math.PI/180),b*(Math.PI/180),!1);isNaN(g)||g===0?a.fill():(a.lineWidth=g||1,a.stroke());a.restore()};a.polygon=function(a,e,c,d){var b=a.context;b.save();b.fillStyle=b.strokeStyle=e;b.beginPath();c.forEach(function(a,d){d==0?b.moveTo(a[0],a[1]):b.lineTo(a[0],a[1])});b.closePath();isNaN(d)||d===0?b.fill():(b.lineWidth=d||1,b.stroke());b.restore()}}},[]);
require.define({"gamejs/pathfinding/astar":function(f,a){function h(){var a={};this.store=function(b,c){a[b[0]+"-"+b[1]]=c};this.find=function(b){return a[b[0]+"-"+b[1]]};return this}var e=f("../utils/binaryheap").BinaryHeap;a.findRoute=function(a,b,c,j){function i(a){k.push(a);m.store(a.point,a)}function f(b){var c=m.find(b),g=n.length+a.actualDistance(n.point,b);if(!c||c.length>g)c&&k.remove(c),i({point:b,from:n,length:g})}var k=new e(function(b){if(b.score===void 0)b.score=a.estimatedDistance(b.point,
c)+b.length;return b.score}),m=new h;i({point:b,from:null,length:0});for(var b=Date.now(),n=null;k.size()>0&&(!j||Date.now()-b<j);){n=k.pop();if(c[0]===n.point[0]&&c[1]===n.point[1])return n;a.adjacent(n.point).forEach(f)}return null};var c=a.Map=function(){throw Error("not instantiable, this is an interface");};c.prototype.adjacent=function(){};c.prototype.estimatedDistance=function(){};c.prototype.actualDistance=function(){}}},["gamejs/utils/binaryheap"]);
require.define({"gamejs/surfacearray":function(f,a){var h=f("../gamejs"),e=f("./utils/objects").accessors;a.blitArray=function(a,d){a.context.putImageData(d.imageData,0,0)};a.SurfaceArray=function(a){this.set=function(a,c,g){a=a*4+c*d[0]*4;b[a]=g[0];b[a+1]=g[1];b[a+2]=g[2];b[a+3]=g[3]===void 0?255:g[3]};this.get=function(a,c){var g=a*4+c*d[0]*4;return[b[g],b[g+1],b[g+2],b[g+3]]};this.surface=null;e(this,{surface:{get:function(){var a=new h.Surface(d);a.context.putImageData(g,0,0);return a}},imageData:{get:function(){return g}}});
this.getSize=function(){return d};var d=null,b=null,g=null;a instanceof Array?(d=a,g=h.display.getSurface().context.createImageData(d[0],d[1]),b=g.data):(d=a.getSize(),b=g=a.getImageData(0,0,d[0],d[1]));return this}}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/image":function(f,a){var h=f("../gamejs"),e={};a.load=function(a){var d;if(typeof a==="string"){if(d=e[a],!d)throw Error('Missing "'+a+'", gamejs.preload() all images before trying to load them.');}else d=a;a=document.createElement("canvas");a.width=d.naturalWidth||d.width;a.height=d.naturalHeight||d.height;a.getContext("2d").drawImage(d,0,0);d.getSize=function(){return[d.naturalWidth,d.naturalHeight]};var b=new h.Surface(d.getSize());b._canvas=a;return b};a.init=function(){};
a.preload=function(a){function d(){j++;j%10===0&&h.log("gamejs.image: preloaded  "+j+" of "+i)}function b(){e[this.gamejsKey]=this;d()}function g(){d();throw Error("Error loading "+this.src);}var j=0,i=0,f;for(f in a)if(!(f.indexOf("png")==-1&&f.indexOf("jpg")==-1&&f.indexOf("gif")==-1)){var k=new Image;k.addEventListener("load",b,!0);k.addEventListener("error",g,!0);k.src=a[f];k.gamejsKey=f;i++}return function(){return i>0?j/i:1}}}},["gamejs"]);
require.define({"gamejs/mask":function(f,a){var h=f("../gamejs"),e=f("./utils/objects");a.fromSurface=function(a,b){for(var b=b&&255-b||255,g=a.getImageData(),e=a.getSize(),i=new c(e),f=0;f<g.length;f+=4){var h=parseInt(f/4/e[0],10),m=parseInt(f/4%e[0],10);g[f+3]>=b&&i.setAt(m,h)}return i};var c=a.Mask=function(a){this.width=a[0];this.height=a[1];this._bits=[];for(a=0;a<this.width;a++){this._bits[a]=[];for(var b=0;b<this.height;b++)this._bits[a][b]=!1}};c.prototype.overlapRect=function(a,b){var c=
this.rect,e=a.rect;b&&e.moveIp(b);if(!e.collideRect(c))return null;var f=Math.max(c.left,e.left),l=Math.max(c.top,e.top);return new h.Rect([f,l],[Math.min(c.right,e.right)-f,Math.min(c.bottom,e.bottom)-l])};c.prototype.overlap=function(a,b){var c=this.overlapRect(a,b);if(c===null)return!1;var e=this.rect,f=a.rect;b&&f.moveIp(b);for(var h=c.top;h<=c.bottom;h++)for(var k=c.left;k<=c.right;k++)if(this.getAt(k-e.left,h-e.top)&&a.getAt(k-f.left,h-f.top))return!0;return!1};c.prototype.overlapArea=function(a,
b){var c=this.overlapRect(a,b);if(c===null)return 0;var e=this.rect,f=a.rect;b&&f.moveIp(b);for(var h=0,k=c.top;k<=c.bottom;k++)for(var m=c.left;m<=c.right;m++)this.getAt(m-e.left,k-e.top)&&a.getAt(m-f.left,k-f.top)&&h++;return h};c.prototype.overlapMask=function(a,b){var g=this.overlapRect(a,b);if(g===null)return 0;var e=this.rect,f=a.rect;b&&f.moveIp(b);for(var h=new c([g.width,g.height]),k=g.top;k<=g.bottom;k++)for(var m=g.left;m<=g.right;m++)this.getAt(m-e.left,k-e.top)&&a.getAt(m-f.left,k-f.top)&&
h.setAt(m,k);return h};c.prototype.setAt=function(a,b){this._bits[a][b]=!0};c.prototype.getAt=function(a,b){a=parseInt(a,10);b=parseInt(b,10);if(a<0||b<0||a>=this.width||b>=this.height)return!1;return this._bits[a][b]};c.prototype.invert=function(){this._bits=this._bits.map(function(a){return a.map(function(a){return!a})})};c.prototype.getSize=function(){return[this.width,this.height]};e.accessors(c.prototype,{rect:{get:function(){return new h.Rect([0,0],[this.width,this.height])}},length:{get:function(){var a=
0;this._bits.forEach(function(b){b.forEach(function(b){b&&a++})});return a}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/mixer":function(f,a){function h(a){a instanceof Array||(a=[a]);a.forEach(function(a){e[a.gamejsKey]=a})}f("../gamejs");var e={},c=!1;a.init=function(){var a=Array.prototype.slice.call(document.getElementsByTagName("audio"),0);h(a)};a.preload=function(a){function b(){h(this);f++;f==e&&(c=!1)}function g(){f++;f==e&&(c=!1);throw Error("Error loading "+this.src);}var e=0,f=0,l;for(l in a)if(!(l.indexOf("wav")==-1&&l.indexOf("ogg")==-1&&l.indexOf("webm")==-1)){e++;var k=new Audio;
k.addEventListener("canplay",b,!0);k.addEventListener("error",g,!0);k.src=a[l];k.gamejsKey=l;k.load()}e>0&&(c=!0);return function(){return e>0?f/e:1}};a.isPreloading=function(){return c};a.Sound=function(a){var b;b=typeof a==="string"?e[a]:a;if(!b)throw Error('Missing "'+a+'", gamejs.preload() all audio files before loading');var c=this.audio=new Audio;c.preload="auto";c.loop=!1;c.src=b.src;this.play=function(){(c.ended||c.paused)&&c.play()};this.stop=function(){c.pause()};this.setVolume=function(a){c.volume=
a};this.getVolume=function(){return c.volume};this.getLength=function(){return c.duration};return this}}},["gamejs"]);
require.define({"gamejs/http":function(f,a){function h(a){return eval("("+a.responseText+")")}a.Response=function(){this.getResponseHeader=function(){};throw Error("response class not instantiable");};var e=a.ajax=function(a,c,d,e){var d=d||null,f=new XMLHttpRequest;f.open(a,c,!1);e&&f.setRequestHeader("Accept",e);d instanceof Object&&(d=JSON.stringify(d),f.setRequestHeader("Content-Type","application/json"));f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.send(d);return f},c=a.get=function(a){return e("GET",
a)},d=a.post=function(a,c,d){return e("POST",a,c,d)};a.load=function(a){return h(c((window.$g&&$g.ajaxBaseHref||"./")+a))};a.save=function(a,c,e){return h(d((window.$g&&$g.ajaxBaseHref||"./")+a,{payload:c},e))}}},[]);
require.define({gamejs:function(f,a){function h(){var a=0,b=0,c=0,d=0;if(arguments.length===2)arguments[0]instanceof Array&&arguments[1]instanceof Array?(a=arguments[0][0],b=arguments[0][1],c=arguments[1][0],d=arguments[1][1]):(a=arguments[0],b=arguments[1]);else if(arguments.length===1&&arguments[0]instanceof Array)a=arguments[0][0],b=arguments[0][1],c=arguments[0][2],d=arguments[0][3];else if(arguments.length===1&&arguments[0]instanceof j)a=arguments[0].left,b=arguments[0].top,c=arguments[0].width,
d=arguments[0].height;else if(arguments.length===4)a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3];else throw Error("not a valid rectangle specification");return{left:a||0,top:b||0,width:c||0,height:d||0}}var e=f("./gamejs/utils/matrix"),c=f("./gamejs/utils/objects"),d=["info","warn","error","fatal"],b=2;a.setLogLevel=function(a){if(typeof a==="string"&&d.indexOf(a))b=d.indexOf(a);else if(typeof a==="number")b=a;else throw Error("invalid logLevel ",a," Must be one of: ",d);return b};var g=
a.log=function(){var a=Array.prototype.slice.apply(arguments,[0]);a.unshift(Date.now());window.console!==void 0&&console.log.apply&&console.log.apply(console,a)};a.info=function(){b<=d.indexOf("info")&&g.apply(this,arguments)};a.warn=function(){b<=d.indexOf("warn")&&g.apply(this,arguments)};a.error=function(){b<=d.indexOf("error")&&g.apply(this,arguments)};a.fatal=function(){b<=d.indexOf("fatal")&&g.apply(this,arguments)};var j=a.Rect=function(){var a=h.apply(this,arguments);this.left=a.left;this.top=
a.top;this.width=a.width;this.height=a.height;return this};c.accessors(j.prototype,{bottom:{get:function(){return this.top+this.height},set:function(a){this.top=a-this.height}},right:{get:function(){return this.left+this.width},set:function(a){this.left=a-this.width}},center:{get:function(){return[this.left+this.width/2,this.top+this.height/2]},set:function(){var a=h.apply(this,arguments);this.left=a.left-this.width/2;this.top=a.top-this.height/2}}});j.prototype.move=function(){var a=h.apply(this,
arguments);return new j(this.left+a.left,this.top+a.top,this.width,this.height)};j.prototype.moveIp=function(){var a=h.apply(this,arguments);this.left+=a.left;this.top+=a.top};j.prototype.clip=function(a){if(!this.collideRect(a))return new j(0,0,0,0);var b,c,d,e;if(this.left>=a.left&&this.left<a.right)b=this.left;else if(a.left>=this.left&&a.left<this.right)b=a.left;this.right>a.left&&this.right<=a.right?d=this.right-b:a.right>this.left&&a.right<=this.right&&(d=a.right-b);if(this.top>=a.top&&this.top<
a.bottom)c=this.top;else if(a.top>=this.top&&a.top<this.bottom)c=a.top;this.bottom>a.top&&this.bottom<=a.bottom?e=this.bottom-c:a.bottom>this.top&&a.bottom<=this.bottom&&(e=a.bottom-c);return new j(b,c,d,e)};j.prototype.union=function(a){var b,c;b=Math.min(this.left,a.left);c=Math.min(this.top,a.top);return new j(b,c,Math.max(this.right,a.right)-b,Math.max(this.bottom,a.bottom)-c)};j.prototype.collidePoint=function(){var a=h.apply(this,arguments);return this.left<=a.left&&a.left<=this.right&&this.top<=
a.top&&a.top<=this.bottom};j.prototype.collideRect=function(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)};j.prototype.collideLine=function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],g=!0,h=!0,i=!0;[[this.left,this.top],[this.left,this.bottom],[this.right,this.top],[this.right,this.bottom]].map(function(a){return(f-d)*a[0]+(c-e)*a[1]+(e*d-c*f)}).forEach(function(a){a>0?h=!1:a<0?g=!1:a===0&&(i=!1)},this);if((g||h)&&i)return!1;return!(c>this.right&&e>this.right||c<
this.left&&e<this.left||d<this.top&&f<this.top||d>this.bottom&&f>this.bottom)};j.prototype.toString=function(){return["[",this.left,",",this.top,"] [",this.width,",",this.height,"]"].join("")};j.prototype.clone=function(){return new j(this)};var i=a.Surface=function(){var a=h.apply(this,arguments),b=a.left,c=a.top;if(arguments.length==1&&arguments[0]instanceof j)b=a.width,c=a.height;this._matrix=e.identity();this._canvas=document.createElement("canvas");this._canvas.width=b;this._canvas.height=c;
this._blitAlpha=1;return this};i.prototype.blit=function(a,b,c){if(b instanceof j){var b=b.clone(),d=a.getSize();if(!b.width)b.width=d[0];if(!b.height)b.height=d[1]}else b=b&&b instanceof Array&&b.length==2?new j(b,a.getSize()):new j([0,0],a.getSize());c=c instanceof j?c:c&&c instanceof Array&&c.length==2?new j(c,a.getSize()):new j([0,0],a.getSize());if(isNaN(b.left)||isNaN(b.top)||isNaN(b.width)||isNaN(b.height))throw Error("[blit] bad parameters, destination is "+b);this.context.save();d=e.translate(e.identity(),
b.left,b.top);d=e.multiply(d,a._matrix);this.context.transform(d[0],d[1],d[2],d[3],d[4],d[5]);srcRect=a.getRect();this.context.globalAlpha=a._blitAlpha;this.context.drawImage(a.canvas,c.left,c.top,c.width,c.height,0,0,b.width,b.height);this.context.restore()};i.prototype.getSize=function(){return[this.canvas.width,this.canvas.height]};i.prototype.getRect=function(){return new j([0,0],this.getSize())};i.prototype.fill=function(a){this.context.save();this.context.fillStyle=a||"#000000";this.context.fillRect(0,
0,this.canvas.width,this.canvas.height);this.context.restore()};i.prototype.clear=function(){var a=this.getSize();this.context.clearRect(0,0,a[0],a[1])};c.accessors(i.prototype,{rect:{get:function(){return this.getRect()}},context:{get:function(){return this._canvas.getContext("2d")}},canvas:{get:function(){return this._canvas}}});i.prototype.clone=function(){var a=new i(this.getRect());a.blit(this);return a};i.prototype.getAlpha=function(){return 1-this._blitAlpha};i.prototype.setAlpha=function(a){if(!isNaN(a)&&
!(a<0||a>1))return this._blitAlpha=1-a,1-this._blitAlpha};i.prototype.getImageData=function(){var a=this.getSize();return this.context.getImageData(0,0,a[0],a[1]).data};a.display=f("./gamejs/display");a.draw=f("./gamejs/draw");a.event=f("./gamejs/event");a.font=f("./gamejs/font");a.http=f("./gamejs/http");a.image=f("./gamejs/image");a.mask=f("./gamejs/mask");a.mixer=f("./gamejs/mixer");a.sprite=f("./gamejs/sprite");a.surfacearray=f("./gamejs/surfacearray");a.time=f("./gamejs/time");a.transform=f("./gamejs/transform");
a.utils={arrays:f("./gamejs/utils/arrays"),objects:f("./gamejs/utils/objects"),matrix:f("./gamejs/utils/matrix"),vectors:f("./gamejs/utils/vectors"),math:f("./gamejs/utils/math")};a.pathfinding={astar:f("./gamejs/pathfinding/astar")};var l=a,k={};a.ready=function(a){function b(){if(!document.body)return window.setTimeout(b,50);e=l.image.preload(k);try{d=l.mixer.preload(k)}catch(a){l.debug("Error loading audio files ",a)}window.setTimeout(c,50)}function c(){if(e()<1||d()<1)return window.setTimeout(c,
100);l.display.init();l.image.init();l.mixer.init();l.event.init();a()}var d=null,e=null;l.time.init();window.setTimeout(b,13);return function(){if(e)return 0.5*e()+0.5*d();return 0.1}};a.preload=function(a){var b=window.$g&&$g.resourceBaseHref||".";b.slice(-1)=="/"&&(b=b.slice(0,b.length-1));a.forEach(function(a){k[a]=(window.$g&&$g.resourceBaseHref||".")+("/"+a).replace(/\/+/g,"/")},this)}}},["gamejs/utils/matrix","gamejs/utils/objects","gamejs/display","gamejs/draw","gamejs/event","gamejs/font",
"gamejs/http","gamejs/image","gamejs/mask","gamejs/mixer","gamejs/sprite","gamejs/surfacearray","gamejs/time","gamejs/transform","gamejs/utils/arrays","gamejs/utils/vectors","gamejs/utils/math","gamejs/pathfinding/astar"]);
