require.define({"gamejs/display":function(f,a){var g=f("../gamejs").Surface,e=null;a.init=function(){var b=null;d()===null&&(b=document.createElement("canvas"),b.setAttribute("id","gjs-canvas"),document.body.appendChild(b));(b=document.getElementById("gjs-loader"))&&b.parentNode.removeChild(b)};a.setMode=function(b){var m=d();m.width=b[0];m.height=b[1];return c()};a.setCaption=function(b){document.title=b};a._getCanvasOffset=function(){var b=d().getBoundingClientRect();return[b.left,b.top]};var c=
a.getSurface=function(){if(e===null){var b=d();e=new g([b.clientWidth,b.clientHeight]);e._canvas=b}return e},d=function(){var b=null;Array.prototype.slice.call(document.getElementsByTagName("canvas")).every(function(d){if(d.getAttribute("id")=="gjs-canvas")return b=d,!1;return!0});return b}}},["gamejs"]);
require.define({"gamejs/draw":function(f,a){a.line=function(a,e,c,d,b){a=a.context;a.save();a.beginPath();a.strokeStyle=e;a.lineWidth=b||1;a.moveTo(c[0],c[1]);a.lineTo(d[0],d[1]);a.stroke();a.restore()};a.lines=function(a,e,c,d,b){c=c||!1;a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;for(e=0;e<d.length;e++)b=d[e],e===0?a.moveTo(b[0],b[1]):a.lineTo(b[0],b[1]);c&&a.lineTo(d[0][0],d[0][1]);a.stroke();a.restore()};a.circle=function(a,e,c,d,b){if(!d)throw Error("[circle] radius required argument");
if(!c||typeof c!=="array")throw Error("[circle] pos must be given & array"+c);a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;a.arc(c[0],c[1],d,0,2*Math.PI,!0);b===void 0||b===0?a.fill():a.stroke();a.restore()};a.rect=function(a,e,c,d){a=a.context;a.save();a.strokeStyle=a.fillStyle=e;isNaN(d)||d===0?a.fillRect(c.left,c.top,c.width,c.height):(a.lineWidth=d,a.strokeRect(c.left,c.top,c.width,c.height));a.restore()};a.arc=function(a,e,c,d,b,m){a=a.context;a.save();a.strokeStyle=
a.fillStyle=e;a.arc(c.center[0],c.center[1],c.width/2,d*(Math.PI/180),b*(Math.PI/180),!1);isNaN(m)||m===0?a.fill():(a.lineWidth=m,a.stroke());a.restore()};a.polygon=function(a,e,c,d){this.lines(a,e,!0,c,d)}}},[]);
require.define({"gamejs/event":function(f,a){var g=f("./display"),e=f("../gamejs");a.K_UP=38;a.K_DOWN=40;a.K_RIGHT=39;a.K_LEFT=37;a.K_SPACE=32;a.K_BACKSPACE=8;a.K_TAB=9;a.K_ENTER=13;a.K_SHIFT=16;a.K_CTRL=17;a.K_ALT=18;a.K_ESC=27;a.K_0=48;a.K_1=49;a.K_2=50;a.K_3=51;a.K_4=52;a.K_5=53;a.K_6=54;a.K_7=55;a.K_8=56;a.K_9=57;a.K_a=65;a.K_b=66;a.K_c=67;a.K_d=68;a.K_e=69;a.K_f=70;a.K_g=71;a.K_h=72;a.K_i=73;a.K_j=74;a.K_k=75;a.K_l=76;a.K_m=77;a.K_n=78;a.K_o=79;a.K_p=80;a.K_q=81;a.K_r=82;a.K_s=83;a.K_t=84;a.K_u=
85;a.K_v=86;a.K_w=87;a.K_x=88;a.K_y=89;a.K_z=90;a.K_KP1=97;a.K_KP2=98;a.K_KP3=99;a.K_KP4=100;a.K_KP5=101;a.K_KP6=102;a.K_KP7=103;a.K_KP8=104;a.K_KP9=105;a.QUIT=0;a.KEY_DOWN=1;a.KEY_UP=2;a.MOUSE_MOTION=3;a.MOUSE_UP=4;a.MOUSE_DOWN=5;a.MOUSE_WHEEL=6;var c=[];a.get=function(){return c.splice(0,c.length)};a.poll=function(){return c.pop()};a.post=function(a){c.push(a)};a.Event=function(){this.pos=this.button=this.rel=this.key=this.type=null};a.init=function(){function d(b){var a=g._getCanvasOffset();c.push({type:e.event.MOUSE_WHEEL,
pos:[b.clientX-a[0],b.clientY-a[1]],delta:b.detail||-b.wheelDeltaY/40})}document.addEventListener("mousedown",function(b){var a=g._getCanvasOffset();c.push({type:e.event.MOUSE_DOWN,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},!1);document.addEventListener("mouseup",function(b){var a=g._getCanvasOffset();c.push({type:e.event.MOUSE_UP,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);document.addEventListener("keydown",function(b){var d=b.keyCode||b.which;c.push({type:e.event.KEY_DOWN,key:d,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey});(!b.ctrlKey&&!b.metaKey&&(d>=a.K_LEFT&&d<=a.K_DOWN||d>=a.K_0&&d<=a.K_z||d>=a.K_KP1&&d<=a.K_KP9||d===a.K_SPACE||d===a.K_TAB||d===a.K_ENTER)||d===a.K_ALT||d===a.K_BACKSPACE)&&b.preventDefault()},!1);document.addEventListener("keyup",function(b){c.push({type:e.event.KEY_UP,key:b.keyCode,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);var b=[];document.addEventListener("mousemove",function(a){var d=g._getCanvasOffset(),d=[a.clientX-d[0],a.clientY-d[1]],j=[];b.length&&(j=[b[0]-d[0],b[1]-d[1]]);c.push({type:e.event.MOUSE_MOTION,pos:d,rel:j,buttons:null,timestamp:a.timeStamp});b=d},!1);document.addEventListener("mousewheel",d,!1);document.addEventListener("DOMMouseScroll",d,!1);document.addEventListener("beforeunload",function(){c.push({type:e.event.QUIT})},!1)}}},["gamejs/display","gamejs"]);
require.define({"gamejs/font":function(f,a){var g=f("../gamejs").Surface,e=f("./utils/objects"),c=a.Font=function(a){this.sampleSurface=new g([10,10]);this.sampleSurface.context.font=a;this.sampleSurface.context.textAlign="start";this.sampleSurface.context.textBaseline="bottom";return this};c.prototype.render=function(a,b){var c=this.size(a),c=new g(c),h=c.context;h.save();h.font=this.sampleSurface.context.font;h.textBaseline=this.sampleSurface.context.textBaseline;h.textAlign=this.sampleSurface.context.textAlign;
h.fillStyle=h.strokeStyle=b||"#000000";h.fillText(a,0,c.rect.height,c.rect.width);h.restore();return c};c.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width,this.fontHeight]};e.accessors(c.prototype,{fontHeight:{get:function(){return this.sampleSurface.context.measureText("M").width*1.5}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/http":function(f,a){function g(b){return eval("("+b.responseText+")")}a.Response=function(){this.getResponseHeader=function(){};throw Error("response class not instantiable");};var e=a.ajax=function(b,a,d,c){var d=d||null,e=new XMLHttpRequest;e.open(b,a,!1);c&&e.setRequestHeader("Accept",c);d instanceof Object&&(d=JSON.stringify(d),e.setRequestHeader("Content-Type","application/json"));e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.send(d);return e},c=a.get=function(b){return e("GET",
b)},d=a.post=function(b,a,d){return e("POST",b,a,d)};a.load=function(b){return g(c((window.$g&&$g.ajaxBaseHref||"./")+b))};a.save=function(b,a,c){return g(d((window.$g&&$g.ajaxBaseHref||"./")+b,{payload:a},c))}}},[]);
require.define({"gamejs/image":function(f,a){var g=f("../gamejs"),e={};a.load=function(a){var d;if(typeof a==="string"){if(d=e[a],!d)throw Error('Missing "'+a+'", gamejs.preload() all images before trying to load them.');}else d=a;a=document.createElement("canvas");a.width=d.naturalWidth||d.width;a.height=d.naturalHeight||d.height;a.getContext("2d").drawImage(d,0,0);d.getSize=function(){return[d.naturalWidth,d.naturalHeight]};var b=new g.Surface(d.getSize());b._canvas=a;return b};a.init=function(){};
a.preload=function(a){function d(){h++;h%10===0&&g.log("gamejs.image: preloaded  "+h+" of "+j)}function b(){e[this.gamejsKey]=this;d()}function m(){d();throw Error("Error loading "+this.src);}var h=0,j=0,i;for(i in a)if(!(i.indexOf("png")==-1&&i.indexOf("jpg")==-1&&i.indexOf("gif")==-1)){var f=new Image;f.addEventListener("load",b,!0);f.addEventListener("error",m,!0);f.src=a[i];f.gamejsKey=i;j++}return function(){return j>0?h/j:1}}}},["gamejs"]);
require.define({"gamejs/mask":function(f,a){var g=f("../gamejs"),e=f("./utils/objects");a.fromSurface=function(a,b){for(var b=b&&255-b||255,m=a.getImageData(),e=a.getSize(),g=new c(e),i=0;i<m.length;i+=4){var f=parseInt(i/4/e[0],10),l=parseInt(i/4%e[0],10);m[i+3]>=b&&g.setAt(l,f)}return g};var c=a.Mask=function(a){this.width=a[0];this.height=a[1];this._bits=[];for(a=0;a<this.width;a++){this._bits[a]=[];for(var b=0;b<this.height;b++)this._bits[a][b]=!1}};c.prototype.overlapRect=function(a,b){var c=
this.rect,e=a.rect;b&&e.moveIp(b);if(!e.collideRect(c))return null;var j=Math.max(c.left,e.left),i=Math.max(c.top,e.top);return new g.Rect([j,i],[Math.min(c.right,e.right)-j,Math.min(c.bottom,e.bottom)-i])};c.prototype.overlap=function(a,b){var c=this.overlapRect(a,b);if(c===null)return!1;var e=this.rect,g=a.rect;b&&g.moveIp(b);for(var i=c.top;i<=c.bottom;i++)for(var f=c.left;f<=c.right;f++)if(this.getAt(f-e.left,i-e.top)&&a.getAt(f-g.left,i-g.top))return!0;return!1};c.prototype.overlapArea=function(a,
b){var c=this.overlapRect(a,b);if(c===null)return 0;var e=this.rect,g=a.rect;b&&g.moveIp(b);for(var f=0,k=c.top;k<=c.bottom;k++)for(var l=c.left;l<=c.right;l++)this.getAt(l-e.left,k-e.top)&&a.getAt(l-g.left,k-g.top)&&f++;return f};c.prototype.overlapMask=function(a,b){var e=this.overlapRect(a,b);if(e===null)return 0;var h=this.rect,g=a.rect;b&&g.moveIp(b);for(var f=new c([e.width,e.height]),k=e.top;k<=e.bottom;k++)for(var l=e.left;l<=e.right;l++)this.getAt(l-h.left,k-h.top)&&a.getAt(l-g.left,k-g.top)&&
f.setAt(l,k);return f};c.prototype.setAt=function(a,b){this._bits[a][b]=!0};c.prototype.getAt=function(a,b){a=parseInt(a,10);b=parseInt(b,10);if(a<0||b<0||a>=this.width||b>=this.height)return!1;return this._bits[a][b]};c.prototype.invert=function(){this._bits=this._bits.map(function(a){return a.map(function(a){return!a})})};c.prototype.getSize=function(){return[this.width,this.height]};e.accessors(c.prototype,{rect:{get:function(){return new g.Rect([0,0],[this.width,this.height])}},length:{get:function(){var a=
0;this._bits.forEach(function(b){b.forEach(function(b){b&&a++})});return a}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/mixer":function(f,a){function g(a){a instanceof Array||(a=[a]);a.forEach(function(a){e[a.gamejsKey]=a})}f("../gamejs");var e={},c=!1;a.init=function(){var a=Array.prototype.slice.call(document.getElementsByTagName("audio"),0);g(a)};a.preload=function(a){function b(){g(this);f++;f==h&&(c=!1)}function e(){f++;f==h&&(c=!1);throw Error("Error loading "+this.src);}var h=0,f=0,i;for(i in a)if(!(i.indexOf("wav")==-1&&i.indexOf("ogg")==-1&&i.indexOf("webm")==-1)){h++;var k=new Audio;
k.addEventListener("canplay",b,!0);k.addEventListener("error",e,!0);k.src=a[i];k.gamejsKey=i;k.load()}h>0&&(c=!0);return function(){return h>0?f/h:1}};a.isPreloading=function(){return c};a.Sound=function(a,b){var c;c=typeof a==="string"?e[a]:a;if(!c)throw Error('Missing "'+a+'", gamejs.preload() all audio files before loading');var h=new Audio;h.preload="auto";h.loop=b?!0:!1;h.src=c.src;this.play=function(){(h.ended||h.paused)&&h.play()};this.isEnded=function(){return h.ended};this.isPaused=function(){return h.paused};
this.getCurrentTime=function(){return h.currentTime};this.seek=function(a){if(a<0)throw Error("Cannot seek audio to negative seconds.");if(a>h.duration)a=h.duration;h.currentTime=a};this.stop=function(){h.pause()};this.setVolume=function(a){h.volume=a};this.getVolume=function(){return h.volume};this.getLength=function(){return h.duration};return this}}},["gamejs"]);
require.define({"gamejs/pathfinding/astar":function(f,a){function g(){var a={};this.store=function(b,c){a[b[0]+"-"+b[1]]=c};this.find=function(b){return a[b[0]+"-"+b[1]]};return this}var e=f("../utils/binaryheap").BinaryHeap;a.findRoute=function(a,b,c,h){function f(a){k.push(a);l.store(a.point,a)}function i(b){var c=l.find(b),e=n.length+a.actualDistance(n.point,b);if(!c||c.length>e)c&&k.remove(c),f({point:b,from:n,length:e})}var k=new e(function(b){if(b.score===void 0)b.score=a.estimatedDistance(b.point,
c)+b.length;return b.score}),l=new g;f({point:b,from:null,length:0});for(var b=Date.now(),n=null;k.size()>0&&(!h||Date.now()-b<h);){n=k.pop();if(c[0]===n.point[0]&&c[1]===n.point[1])return n;a.adjacent(n.point).forEach(i)}return null};var c=a.Map=function(){throw Error("not instantiable, this is an interface");};c.prototype.adjacent=function(){};c.prototype.estimatedDistance=function(){};c.prototype.actualDistance=function(){}}},["gamejs/utils/binaryheap"]);
require.define({"gamejs/sprite":function(f,a){f("../gamejs");var g=f("./utils/arrays"),e=a.Sprite=function(){this._groups=[];this._alive=!0;this.rect=this.image=null;return this};e.prototype.kill=function(){this._alive=!1;this._groups.forEach(function(a){a.remove(this)},this)};e.prototype.remove=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.remove(this)},this)};e.prototype.add=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.add(this)},this)};e.prototype.draw=function(a){a.blit(this.image,
this.rect)};e.prototype.update=function(){};e.prototype.isDead=function(){return!this._alive};var c=a.Group=function(a){this._sprites=[];(a instanceof e||a instanceof Array&&a.length&&a[0]instanceof e)&&this.add(a);return this};c.prototype.update=function(){var a=arguments;this._sprites.forEach(function(c){c.update.apply(c,a)},this)};c.prototype.add=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){this._sprites.push(a);a._groups.push(this)},this)};c.prototype.remove=function(a){a instanceof
Array||(a=[a]);a.forEach(function(a){g.remove(a,this._sprites);g.remove(this,a._groups)},this)};c.prototype.has=function(a){a instanceof Array||(a=[a]);return a.every(function(a){return this._sprites.indexOf(a)!==-1},this)};c.prototype.sprites=function(){return this._sprites};c.prototype.draw=function(){var a=arguments;this._sprites.forEach(function(c){c.draw.apply(c,a)},this)};c.prototype.clear=function(a,c){this._sprites.forEach(function(d){a.blit(c,d.rect)},this)};c.prototype.empty=function(){this._sprites=
[]};c.prototype.collidePoint=function(){var a=Array.prototype.slice.apply(arguments);return this._sprites.filter(function(c){return c.rect.collidePoint.apply(c.rect,a)},this)};c.prototype.forEach=function(){Array.prototype.forEach.apply(this._sprites,arguments)};c.prototype.some=function(){return Array.prototype.some.apply(this._sprites,arguments)};a.spriteCollide=function(a,c,e,g){var g=g||d,e=e||!1,f=[];c.sprites().forEach(function(c){g(a,c)&&(e&&c.kill(),f.push(c))});return f};a.groupCollide=function(a,
c,e,g,f){var e=e||!1,g=g||!1,k=[],l=f||d;a.sprites().forEach(function(a){c.sprites().forEach(function(b){l(a,b)&&(e&&a.kill(),g&&b.kill(),k.push({a:a,b:b}))})});return k};var d=a.collideRect=function(a,c){return a.rect.collideRect(c.rect)};a.collideMask=function(a,c){if(!a.mask||!c.mask)throw Error("Both sprites must have 'mask' attribute set to an gamejs.mask.Mask");return a.mask.overlap(c.mask,[c.rect.left-a.rect.left,c.rect.top-a.rect.top])};a.collideCircle=function(a,c){return a.rect.center[0]*
a.rect.center[0]+a.rect.center[1]*a.rect.center[1]<=(a.radius*a.radius||(a.rect.width*a.rect.width+a.rect.height*a.rect.height)/4)+(c.radius*c.radius||(c.rect.width*c.rect.width+c.rect.height*c.rect.height)/4)}}},["gamejs","gamejs/utils/arrays"]);
require.define({"gamejs/surfacearray":function(f,a){var g=f("../gamejs"),e=f("./utils/objects").accessors;a.blitArray=function(a,d){a.context.putImageData(d.imageData,0,0)};a.SurfaceArray=function(a){this.set=function(a,c,e){a=a*4+c*d[0]*4;b[a]=e[0];b[a+1]=e[1];b[a+2]=e[2];b[a+3]=e[3]===void 0?255:e[3]};this.get=function(a,c){var e=a*4+c*d[0]*4;return[b[e],b[e+1],b[e+2],b[e+3]]};this.surface=null;e(this,{surface:{get:function(){var a=new g.Surface(d);a.context.putImageData(f,0,0);return a}},imageData:{get:function(){return f}}});
this.getSize=function(){return d};var d=null,b=null,f=null;a instanceof Array?(d=a,f=g.display.getSurface().context.createImageData(d[0],d[1]),b=f.data):(d=a.getSize(),b=f=a.getImageData(0,0,d[0],d[1]));return this}}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/time":function(f,a){var g={},e={};a.init=function(){Date.now();setInterval(c,10)};a.fpsCallback=function(a,b,c){c=parseInt(1E3/c,10);g[c]=g[c]||[];e[c]=e[c]||0;g[c].push({rawFn:a,callback:function(c){a.apply(b,[c])}})};a.deleteCallback=function(a,b){var b=parseInt(1E3/b,10),c=g[b];c&&(g[b]=c.filter(function(b){if(b.rawFn!==a)return!0;return!1}))};var c=function(){function a(c){c.callback(h)}var b=Date.now(),c;for(c in e){e[c]||(e[c]=b);var h=b-e[c];c<=h&&(e[c]=b,g[c].forEach(a,
this))}}}},[]);
require.define({"gamejs/transform":function(f,a){var g=f("../gamejs").Surface,e=f("./utils/matrix");a.rotate=function(a,d){var b=a.getSize(),f=new g(b),h=a._matrix;a._matrix=e.translate(a._matrix,b[0]/2,b[1]/2);a._matrix=e.rotate(a._matrix,d*Math.PI/180);a._matrix=e.translate(a._matrix,-b[0]/2,-b[1]/2);f.blit(a);a._matrix=h;return f};a.scale=function(a,d){var b=d[0],f=d[1],h=a.getSize(),h=[h[0]*d[0],h[1]*d[1]],h=new g(h);h._matrix=e.scale(h._matrix,[b,f]);h.blit(a);return h};a.flip=function(a,e,b){var f=
a.getSize(),h=new g(f),j=1,i=1,k=0,l=0;e===!0&&(j=-1,k=-f[0]);b===!0&&(i=-1,l=-f[1]);h.context.save();h.context.scale(j,i);h.context.drawImage(a.canvas,k,l);h.context.restore();return h}}},["gamejs","gamejs/utils/matrix"]);require.define({"gamejs/utils/arrays":function(f,a){a.remove=function(a,e){return e.splice(e.indexOf(a),1)}}},[]);
require.define({"gamejs/utils/binaryheap":function(f,a){var g=a.BinaryHeap=function(a){this.content=[];this.scoreFunction=a;return this};g.prototype.push=function(a){this.content.push(a);this.sinkDown(this.content.length-1)};g.prototype.pop=function(){var a=this.content[0],c=this.content.pop();this.content.length>0&&(this.content[0]=c,this.bubbleUp(0));return a};g.prototype.remove=function(a){if(!this.content.some(function(c,d){if(c==a){var b=this.content.pop();d!=this.content.length&&(this.content[d]=
b,this.scoreFunction(b)<this.scoreFunction(a)?this.sinkDown(d):this.bubbleUp(d));return!0}return!1},this))throw Error("Node not found.");};g.prototype.size=function(){return this.content.length};g.prototype.sinkDown=function(a){for(var c=this.content[a];a>0;){var d=Math.floor((a+1)/2)-1,b=this.content[d];if(this.scoreFunction(c)<this.scoreFunction(b))this.content[d]=c,this.content[a]=b,a=d;else break}};g.prototype.bubbleUp=function(a){for(var c=this.content.length,d=this.content[a],b=this.scoreFunction(d);;){var f=
(a+1)*2,g=f-1,j=null;if(g<c){var i=this.scoreFunction(this.content[g]);i<b&&(j=g)}if(f<c&&this.scoreFunction(this.content[f])<(j===null?b:i))j=f;if(j!==null)this.content[a]=this.content[j],this.content[j]=d,a=j;else break}}}},[]);
require.define({"gamejs/utils/math":function(f,a){a.normaliseDegrees=function(a){a%=360;a<0&&(a+=360);return a};a.normaliseRadians=function(a){a%=2*Math.PI;a<0&&(a+=2*Math.PI);return a};a.degrees=function(a){return a*(180/Math.PI)};a.radians=function(a){return a*(Math.PI/180)}}},[]);
require.define({"gamejs/utils/matrix":function(f,a){a.identity=function(){return[1,0,0,1,0,0]};a.add=function(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2],a[3]+c[3],a[4]+c[4],a[5]+c[5],a[6]+c[6]]};var g=a.multiply=function(a,c){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],a[0]*c[4]+a[2]*c[5]+a[4],a[1]*c[4]+a[3]*c[5]+a[5]]};a.translate=function(a,c,d){return g(a,[1,0,0,1,c,d])};a.rotate=function(a,c){var d=Math.sin(c),b=Math.cos(c);return g(a,[b,d,-d,b,0,0])};
a.rotation=function(a){return Math.atan2(a[1],a[0])};a.scale=function(a,c){return g(a,[c[0],0,0,c[1],0,0])}}},[]);
require.define({"gamejs/utils/objects":function(f,a){a.extend=function(a,d){if(a===void 0)throw Error("unknown subClass");if(d===void 0)throw Error("unknown superClass");var b=new Function;b.prototype=d.prototype;a.prototype=new b;a.prototype.constructor=a;a.superClass=d.prototype;a.superConstructor=d};a.merge=function(){for(var a={},d=arguments.length;d>0;--d){var b=arguments[d-1],e;for(e in b)a[e]=b[e]}return a};var g=a.keys=function(a){if(Object.keys)return Object.keys(a);var d=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,
b)&&d.push(b);return d},e=a.accessor=function(a,d,b,e){Object.defineProperty!==void 0?Object.defineProperty(a,d,{get:b,set:e}):Object.prototype.__defineGetter__!==void 0&&(a.__defineGetter__(d,b),e&&a.__defineSetter__(d,e))};a.accessors=function(a,d){g(d).forEach(function(b){e(a,b,d[b].get,d[b].set)})}}},[]);
require.define({"gamejs/utils/vectors":function(f,a){var g=f("./math");a.distance=function(a,b){return c(e(a,b))};var e=a.substract=function(a,b){return[a[0]-b[0],a[1]-b[1]]};a.add=function(a,b){return[a[0]+b[0],a[1]+b[1]]};a.multiply=function(a,b){if(typeof b==="number")return[a[0]*b,a[1]*b];return[a[0]*b[0],a[1]*b[1]]};a.divide=function(a,b){if(typeof b==="number")return[a[0]/b,a[1]/b];throw Error("only divide by scalar supported");};var c=a.len=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])};
a.unit=function(a){var b=c(a);if(b)return[a[0]/b,a[1]/b];return[0,0]};a.rotate=function(a,b){b=g.normaliseRadians(b);return[a[0]*Math.cos(b)-a[1]*Math.sin(b),a[0]*Math.sin(b)+a[1]*Math.cos(b)]};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};a.angle=function(a,b){var e=c(a),f=c(b);return e&&f?Math.acos((a[0]*b[0]+a[1]*b[1])/(e*f)):0}}},["gamejs/utils/math"]);
require.define({gamejs:function(f,a){function g(){var a=0,b=0,c=0,e=0;if(arguments.length===2)arguments[0]instanceof Array&&arguments[1]instanceof Array?(a=arguments[0][0],b=arguments[0][1],c=arguments[1][0],e=arguments[1][1]):(a=arguments[0],b=arguments[1]);else if(arguments.length===1&&arguments[0]instanceof Array)a=arguments[0][0],b=arguments[0][1],c=arguments[0][2],e=arguments[0][3];else if(arguments.length===1&&arguments[0]instanceof h)a=arguments[0].left,b=arguments[0].top,c=arguments[0].width,
e=arguments[0].height;else if(arguments.length===4)a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3];else throw Error("not a valid rectangle specification");return{left:a||0,top:b||0,width:c||0,height:e||0}}var e=f("./gamejs/utils/matrix"),c=f("./gamejs/utils/objects"),d=["info","warn","error","fatal"],b=2;a.setLogLevel=function(a){if(typeof a==="string"&&d.indexOf(a))b=d.indexOf(a);else if(typeof a==="number")b=a;else throw Error("invalid logLevel ",a," Must be one of: ",d);return b};var m=
a.log=function(){var a=Array.prototype.slice.apply(arguments,[0]);a.unshift(Date.now());window.console!==void 0&&console.log.apply&&console.log.apply(console,a)};a.info=function(){b<=d.indexOf("info")&&m.apply(this,arguments)};a.warn=function(){b<=d.indexOf("warn")&&m.apply(this,arguments)};a.error=function(){b<=d.indexOf("error")&&m.apply(this,arguments)};a.fatal=function(){b<=d.indexOf("fatal")&&m.apply(this,arguments)};var h=a.Rect=function(){var a=g.apply(this,arguments);this.left=a.left;this.top=
a.top;this.width=a.width;this.height=a.height;return this};c.accessors(h.prototype,{bottom:{get:function(){return this.top+this.height},set:function(a){this.top=a-this.height}},right:{get:function(){return this.left+this.width},set:function(a){this.left=a-this.width}},center:{get:function(){return[this.left+this.width/2,this.top+this.height/2]},set:function(){var a=g.apply(this,arguments);this.left=a.left-this.width/2;this.top=a.top-this.height/2}}});h.prototype.move=function(){var a=g.apply(this,
arguments);return new h(this.left+a.left,this.top+a.top,this.width,this.height)};h.prototype.moveIp=function(){var a=g.apply(this,arguments);this.left+=a.left;this.top+=a.top};h.prototype.clip=function(a){if(!this.collideRect(a))return new h(0,0,0,0);var b,c,e,d;if(this.left>=a.left&&this.left<a.right)b=this.left;else if(a.left>=this.left&&a.left<this.right)b=a.left;this.right>a.left&&this.right<=a.right?e=this.right-b:a.right>this.left&&a.right<=this.right&&(e=a.right-b);if(this.top>=a.top&&this.top<
a.bottom)c=this.top;else if(a.top>=this.top&&a.top<this.bottom)c=a.top;this.bottom>a.top&&this.bottom<=a.bottom?d=this.bottom-c:a.bottom>this.top&&a.bottom<=this.bottom&&(d=a.bottom-c);return new h(b,c,e,d)};h.prototype.union=function(a){var b,c;b=Math.min(this.left,a.left);c=Math.min(this.top,a.top);return new h(b,c,Math.max(this.right,a.right)-b,Math.max(this.bottom,a.bottom)-c)};h.prototype.collidePoint=function(){var a=g.apply(this,arguments);return this.left<=a.left&&a.left<=this.right&&this.top<=
a.top&&a.top<=this.bottom};h.prototype.collideRect=function(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)};h.prototype.collideLine=function(a,b){var c=a[0],e=a[1],d=b[0],f=b[1],g=!0,h=!0,i=!0;[[this.left,this.top],[this.left,this.bottom],[this.right,this.top],[this.right,this.bottom]].map(function(a){return(f-e)*a[0]+(c-d)*a[1]+(d*e-c*f)}).forEach(function(a){a>0?h=!1:a<0?g=!1:a===0&&(i=!1)},this);if((g||h)&&i)return!1;return!(c>this.right&&d>this.right||c<
this.left&&d<this.left||e<this.top&&f<this.top||e>this.bottom&&f>this.bottom)};h.prototype.toString=function(){return["[",this.left,",",this.top,"] [",this.width,",",this.height,"]"].join("")};h.prototype.clone=function(){return new h(this)};var j=a.Surface=function(){var a=g.apply(this,arguments),b=a.left,c=a.top;if(arguments.length==1&&arguments[0]instanceof h)b=a.width,c=a.height;this._matrix=e.identity();this._canvas=document.createElement("canvas");this._canvas.width=b;this._canvas.height=c;
this._blitAlpha=1;return this};j.prototype.blit=function(a,b,c){if(b instanceof h){var b=b.clone(),d=a.getSize();if(!b.width)b.width=d[0];if(!b.height)b.height=d[1]}else b=b&&b instanceof Array&&b.length==2?new h(b,a.getSize()):new h([0,0],a.getSize());c=c instanceof h?c:c&&c instanceof Array&&c.length==2?new h(c,a.getSize()):new h([0,0],a.getSize());if(isNaN(b.left)||isNaN(b.top)||isNaN(b.width)||isNaN(b.height))throw Error("[blit] bad parameters, destination is "+b);this.context.save();d=e.translate(e.identity(),
b.left,b.top);d=e.multiply(d,a._matrix);this.context.transform(d[0],d[1],d[2],d[3],d[4],d[5]);srcRect=a.getRect();this.context.globalAlpha=a._blitAlpha;this.context.drawImage(a.canvas,c.left,c.top,c.width,c.height,0,0,b.width,b.height);this.context.restore()};j.prototype.getSize=function(){return[this.canvas.width,this.canvas.height]};j.prototype.getRect=function(){return new h([0,0],this.getSize())};j.prototype.fill=function(a){this.context.save();this.context.fillStyle=a||"#000000";this.context.fillRect(0,
0,this.canvas.width,this.canvas.height);this.context.restore()};j.prototype.clear=function(){var a=this.getSize();this.context.clearRect(0,0,a[0],a[1])};c.accessors(j.prototype,{rect:{get:function(){return this.getRect()}},context:{get:function(){return this._canvas.getContext("2d")}},canvas:{get:function(){return this._canvas}}});j.prototype.clone=function(){var a=new j(this.getRect());a.blit(this);return a};j.prototype.getAlpha=function(){return 1-this._blitAlpha};j.prototype.setAlpha=function(a){if(!isNaN(a)&&
!(a<0||a>1))return this._blitAlpha=1-a,1-this._blitAlpha};j.prototype.getImageData=function(){var a=this.getSize();return this.context.getImageData(0,0,a[0],a[1]).data};a.display=f("./gamejs/display");a.draw=f("./gamejs/draw");a.event=f("./gamejs/event");a.font=f("./gamejs/font");a.http=f("./gamejs/http");a.image=f("./gamejs/image");a.mask=f("./gamejs/mask");a.mixer=f("./gamejs/mixer");a.sprite=f("./gamejs/sprite");a.surfacearray=f("./gamejs/surfacearray");a.time=f("./gamejs/time");a.transform=f("./gamejs/transform");
a.utils={arrays:f("./gamejs/utils/arrays"),objects:f("./gamejs/utils/objects"),matrix:f("./gamejs/utils/matrix"),vectors:f("./gamejs/utils/vectors"),math:f("./gamejs/utils/math")};a.pathfinding={astar:f("./gamejs/pathfinding/astar")};var i=a,k={};a.ready=function(a){function b(){if(!document.body)return window.setTimeout(b,50);e=i.image.preload(k);try{d=i.mixer.preload(k)}catch(a){i.debug("Error loading audio files ",a)}window.setTimeout(c,50)}function c(){if(e()<1||d()<1)return window.setTimeout(c,
100);i.display.init();i.image.init();i.mixer.init();i.event.init();a()}var d=null,e=null;i.time.init();window.setTimeout(b,13);return function(){if(e)return 0.5*e()+0.5*d();return 0.1}};a.preload=function(a){var b=window.$g&&$g.resourceBaseHref||".";b[b.length-1]=="/"&&(b=b.slice(0,b.length-1));a.forEach(function(a){a[0]=="/"&&(a=a.slice(1,a.length));k[a]=b+"/"+a},this)}}},["gamejs/utils/matrix","gamejs/utils/objects","gamejs/display","gamejs/draw","gamejs/event","gamejs/font","gamejs/http","gamejs/image",
"gamejs/mask","gamejs/mixer","gamejs/sprite","gamejs/surfacearray","gamejs/time","gamejs/transform","gamejs/utils/arrays","gamejs/utils/vectors","gamejs/utils/math","gamejs/pathfinding/astar"]);
